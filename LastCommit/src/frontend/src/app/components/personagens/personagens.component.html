<div class="characters-page">
  <div class="characters-container">

    <section class="characters-list-section">
      <h2 class="section-title">Personagens Criados</h2>
      <ul class="characters-list">
        <li *ngFor="let character of characters" class="character-card">
          <div class="character-info">
            <div class="details">
              <strong>{{ character.nome }}</strong>
              <span>Classe: {{ character.role }}</span>
              <span>HP: {{ character.hpAtual }}</span>
              <span>Ataque Especial: {{ character.ataqueEspecial }}</span>
            </div>
          </div>
          <div class="card-buttons">
            <button class="delete-btn" (click)="confirmDeleteCharacter(character)">Deletar</button>
          </div>
        </li>
      </ul>
      <p *ngIf="characters.length === 0" class="empty-msg">
        Nenhum personagem criado ainda. Comece a criar o seu!
      </p>
    </section>

    <section class="create-character-section">
      <h2 class="section-title">Criar Novo Personagem</h2>
      <form (ngSubmit)="createCharacter()">

      
        <div class="form-group">
          <label for="newCharName">Nome do Personagem:</label>
          <input type="text" id="newCharName" [(ngModel)]="newCharacter.nome" name="nome" placeholder="Nome Completo" required>
        </div>

        <div class="form-group">
          <label for="classeSelect">Escolha a Classe:</label>
          <select id="classeSelect" [(ngModel)]="newCharacter.role" name="role" (change)="onClasseChange(newCharacter.role ?? '')" required>
            <option value="" disabled selected>Selecione uma classe</option>
            <option *ngFor="let classe of classesDisponiveis" [value]="classe.nome">{{ classe.nome }}</option>
          </select>
        </div>

        <div *ngIf="newCharacter.role">
          <p><strong>Descrição:</strong> {{ getClasseSelecionada()?.descricao }}</p>
          <p><strong>HP Inicial:</strong> {{ newCharacter.hpAtual }}</p>
          <p><strong>Ataque Especial:</strong> {{ newCharacter.ataqueEspecial }}</p>
        </div>

        <button type="submit" class="btn btn-create">Criar Personagem</button>
      </form>
    </section>

  </div>
</div>


<div class="modal-overlay" *ngIf="showDeleteConfirmModal">
  <div class="modal">
    <h2>Atenção!</h2>
    <p>Tem certeza que deseja deletar o personagem <strong>{{ characterToDelete?.nome }}</strong>?</p>
    <p>Esta ação não pode ser desfeita.</p>
    <div class="modal-actions">
      <button class="btn btn-secondary" (click)="closeDeleteConfirmationModal()">Cancelar</button>
      <button class="delete-btn" (click)="executeDelete()">Deletar Permanentemente</button>
    </div>
  </div>
</div>


<div class="modal-overlay" *ngIf="showCharacterExistsModal">
  <div class="modal">
    <h2>Erro de Exterminador</h2>
    <p>Você já possui um exterminador com esse nome. Escolha outro.</p>
    <button (click)="closeCharacterExistsModal()">Fechar</button>
  </div>
</div>

<div class="modal-overlay" *ngIf="showSuccessModal">
  <div class="modal">
    <h2>Agora o chinelo vai cantar.</h2>
    <p>Exterminador criado com sucesso.</p>
    <button (click)="closeSuccessModal()">OK</button>
  </div>
</div>

<div class="modal-overlay" *ngIf="showValidationModal">
  <div class="modal">
    <h2>Calma lá!</h2>
    <p>Por favor, preencha os campos antes de criar o exterminador.</p>
    <button (click)="showValidationModal=false">Fechar</button>
  </div>
</div>

<div class="modal-overlay" *ngIf="showModal">
  <div class="modal" [ngClass]="{'modal-error': modalType === 'error', 'modal-success': modalType === 'success'}">
    <h2>{{ modalType === 'success' ? 'Sucesso!' : 'Erro!' }}</h2>
    <p>{{ modalMessage }}</p>
    <button (click)="closeModal()">Fechar</button>
  </div>
</div>